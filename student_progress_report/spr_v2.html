<!DOCTYPE HTML>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link rel="stylesheet" href="css/bootstrap.min.css">
    <link rel="stylesheet" href="css/style.css">
    <script src="js/jquery.min.js"></script>
    <script src="js/bootstrap.min.js"></script>
    <script src="js/Chart.bundle.js"></script>  <!-- for chart -->
    <script src="js/utils.js"></script>  <!-- for chart -->
    <!--script src="data_script.js"></script-->
    
    <style>
    canvas {
        -moz-user-select: none;
        -webkit-user-select: none;
        -ms-user-select: none;
    }
    </style>
    
    <script type="text/javascript" src="js/mustache.js"></script>   <!-- for mustache -->
    
    
</head> 
<body>
<div id="test1">

</div>
<div id="target">
<center><img src="loader1.gif" class='img-responsive loading_img' id='loading_img' style='widht:500px;height:500px;'/></center><br>
<center><p id="p1" class='p1' style='font-size:20px;font-weight: bold;color:green; text-align:center;'>Loading...</p><p id="test" style='font-size:20px;font-weight: bold;color:red; text-align:center;'></p></center><br/>
</div>

<script id="template" type="x-tmpl-mustache">   
{{#papers}}
    {{#users}}
        <div class='container'>
            <div class='row'>
                <div class='col-md-12'>
                    <img src='Rao-IIT-Full-New-website-Logo.png' class='img-responsive'/>
                </div>
            </div>
            <hr/>
            <div class='row'>
                <!-- Header Table -->
                <div class='col-md-12'>
                    <table class='table table-bordered table-responsive table-responsive table-condensed' border=1  cellspacing=0 style='empty-cells: hide;'>
                        <tr style='background-color: #3f51b5 ; color:#fff; height:20px !important;' align="center">
                            <td colspan='4' ><p style='font-size:20px;font-weight: bold;color:white; text-align:center;'>{{ name }}</p></td>
                        </tr>
                        <tr>
                            <td><b>Name</b></td>
                        <td>{{ stufname }} {{ stulname }}</td>
                            <td><b>Roll No</b></td>
                             <td>{{ rollnumber }}</td>
                        </tr>
                        <tr colspan="3">
                           
                            <td><b>Target Course</b></td>
                            <td>{{ course }} Target-{{ targetyear }}</td>
                        </tr>
    {{/users}}
{{/papers}}
    
    {{#spr}}
        {{#total}}
                            <tr>
                                <td><b>Total Marks</b></td>
                                <td>{{ obt }}</td>
                                <td><b>Rank</b></td>
                                <td>{{ rank }}</td>
                            </tr>
        {{/total}}
                        </table>
                    </div>
                </div>
                <hr/>
                <div class='row'>
                    <div class='col-md-12'>
                        <div class='col-md-12' style='background-color: #3f51b5 ;font-weight: bold;color:white;'>
                            <p style='font-size:20px;font-weight: bold;color:white; text-align:center;'>Students Analysis Subjectwise Comparision</p>
                        </div>

                        
                    </div>
                </div>
<!-- Start of Compare chart -->
                <div class='container' id='container'>
                    <div class='row'>
                        <div class='col-md-12' id='chart_compare'>
                            <script>
                                var data = jsonData["spr"];
                                var len = Object.keys(jsonData).length;
                                var sub = ["phy", "chem", "math", "bio", "zoo", "mat", "eng", "lr", "soc", "cs", "gk", "sci", "total"];
                                for(var i=0;i<13;i++)
                                {   
                                    if(data[sub[i]]==null)
                                    {
                                        continue;
                                    }
                                    else
                                    {
                                        //console.log(data[sub[i]].obt);
                                        //For subjectwise comparision
                                        var canvas_id='canvas_comp'+i;
                                        var d="<div class='col-md-6' >"+
                                           "<div id='container' class='chart_div' align='center'>"+
                                                "<canvas id="+canvas_id+" ></canvas>"+
                                            "</div><hr/>"+
                                        "</div>";
                                        var chart_comp= document.getElementById("chart_compare");
                                        chart_comp.innerHTML+=d; 
                                    }
                                }
                                

                                for(var i=0;i<13;i++)
                                {   
                                    if(data[sub[i]]==null)
                                    {
                                        continue;
                                    }
                                    else   //  For subjectwise comparision
                                    {
                                        var canvas_id='canvas_comp'+i;
                                        var barChartData="barChartData"+sub[i];

                                        var color = Chart.helpers.color;
                                        barChartData = {
                                        labels: [data[sub[i]].subject+" Marks Compare with Highest"],
                                        datasets: [{
                                            label: 'SELF',
                                            backgroundColor: color(window.chartColors.green).alpha(1.5).rgbString(),
                                            borderColor: window.chartColors.green,
                                            borderWidth: 3,
                                            data: [
                                                data[sub[i]].obt
                                                
                                            ]
                                        },{
                                            label: 'HIGHEST',
                                            backgroundColor: color(window.chartColors.red).alpha(1.5).rgbString(),
                                            borderColor: window.chartColors.red,
                                            borderWidth: 3,
                                            data: [
                                                data[sub[i]].max_obt
                                                
                                            ]
                                        }]

                                        };
                                        //  For subjectwise graph
                                        var ctx="ctx_"+sub[i];
                                        ctx = document.getElementById(canvas_id).getContext("2d");
                                        window.myBar = new Chart(ctx, {
                                            type: 'bar',
                                            data: barChartData,
                                            options: {
                                                responsive: true,
                                                legend: {
                                                    position: 'top',
                                                },
                                                title: {
                                                    display: true,
                                                    text: data[sub[i]].subject+' Marks Comparision'
                                                },
                                                scales: {
                                                    yAxes: [{
                                                        ticks: {
                                                            //beginAtZero:true
                                                            min:0
                                                        }
                                                    }],
                                                    xAxes: [{
                                                        ticks: {
                                                            //beginAtZero:true
                                                            min:0
                                                        }
                                                    }]
                                                }
                                            }
                                        });
                                    }
                                    
                                }

                                
                            <{{!}}/script>
                        </div>

                    </div>
                </div>
<!-- End of Compare chart -->

<!--For Subjectwise Performance-->
                <div class='container' id='container'>
                    <div class='row'>
                        <div class='col-md-12' id='chart'>

                        </div>
                    </div>
                </div>
<!--End of Subjectwise Performance-->
            </div>
<div class='container'>
    <div class='row'>
        <div class='col-md-12'>
            <center><p class="pull-center"> Copyright &#169; <a href="https://raoiit.com/" target="_blank">Rao IIT Academy</a> 2018</p></center>
        </div>
    </div>
</div>
<script>
    var count=4;
    var data = jsonData["spr"];
    var len = Object.keys(jsonData).length;
    //console.log(Object.keys(jsonData["spr"]));
    var sub = ["phy", "chem", "math", "bio", "zoo", "mat", "eng", "lr", "soc", "cs", "gk", "sci","total"];
    for(var i=0;i<13;i++)
    {   
        if(data[sub[i]]==null)
        {
            count=count+3;
            continue;
        }
        else //For TABLES subjectwise comparision with total marks also
        {
            var data_array = data[sub[i]];
            var canvas_id='canvas'+count;
            var a="<div class='row'>"+
                "<div class='col-md-12'>"+
                    "<div class='col-md-12' style='background-color: #3f51b5 ;font-weight: bold;color:white;'>"+
                        "<p style='font-size:20px;font-weight: bold;color:white; text-align:center;'>"+data_array.subject+" Marks Analysis</p>"+
                    "</div>"+
                    
                    "<div class='col-md-5' style='margin-top:5px'>"+
                        "<table class='table table-bordered table-responsive table-responsive table-condensed myTable' border=1  cellspacing=0 style='empty-cells: hide;' >"+
                            "<tr class='headerStyle' style='font-weight: bold;color:white;' >"+
                                "<td colspan='2'><p style='font-size:20px;font-weight: bold;color:white; text-align:center;'><center>Students Performance in "+data_array.subject+"</center></p></td>"+
                            "</tr>"+
                            "<tr>"+
                                "<th>Total No. Of Questions</th>"+
                                "<td>"+data_array.ques+"</td>"+
                            "</tr>"+
                            "<tr>"+
                                "<th>Correct</th>"+
                                "<td>"+data_array.corr+"</td>"+
                            "</tr>"+
                            "<tr>"+
                                "<th>Wrong</th>"+
                                "<td>"+data_array.wrong+"</td>"+
                            "</tr>"+
                            "<tr>"+
                                "<th>Unattempted</th>"+
                                "<td>"+data_array.unattempt+"</td>"+
                            "</tr>"+
                        "</table>"+
                    "</div>"+

                    "<div class='col-md-6'>"+                    

                        "<div id='container' class='chart_div' align='center'>"+
                            "<canvas id="+canvas_id+" ></canvas>"+
                        "</div>"+
                        
                    "</div>"+
                "</div>"+
            "</div>"+
            "<hr/>";
            count=count+1;

            var canvas_id='canvas'+count;
            var b="<div class='row'>"+
                "<div class='col-md-12'>"+
                    "<div class='col-md-5' style='margin-top:5px'>"+
                        "<table class='table table-bordered table-responsive table-responsive table-condensed myTable' border=1  cellspacing=0 style='empty-cells: hide;' >"+
                            "<tr class='headerStyle' style='font-weight: bold;color:white;' >"+
                                "<td colspan='2' ><p style='font-size:20px;font-weight: bold;color:white; text-align:center;'><center>"+data_array.subject+" Analysis in Percentage</center></p></td>"+
                            "</tr>"+
                            "<tr>"+
                                "<th>Correct</th>"+
                                "<td>"+data_array.corr_percent+"%</td>"+
                            "</tr>"+
                            "<tr>"+
                                "<th>Wrong</th>"+
                                "<td>"+data_array.wrong_percent+"%</td>"+
                            "</tr>"+
                            "<tr>"+
                                "<th>Unattempted</th>"+
                                "<td>"+data_array.unattempt_percent+"%</td>"+
                            "</tr>"+
                            "<tr>"+
                                "<th>Accuracy In Solving</th>"+
                                "<td>"+data_array.corr_accuracy+"%</td>"+
                            "</tr>"+
                        "</table>"+
                    "</div>"+

                    "<div class='col-md-6'> "+                   
                        
                        "<div id='container' class='chart_div' align='center'>"+
                            "<canvas id="+canvas_id+" ></canvas>"+
                        "</div>"+
                        
                    "</div>"+
                "</div>"+
            "</div>"+
            "<hr/>";
            count=count+1;

            var canvas_id='canvas'+count;
            var c="<div class='row'>"+
                "<div class='col-md-12'>"+
                    "<div class='col-md-5' style='margin-top:5px'>"+
                        "<table class='table table-bordered table-responsive table-responsive table-condensed myTable' border=1  cellspacing=0 style='empty-cells: hide;' >"+
                            "<tr class='headerStyle' style='font-weight: bold;color:white;' >"+
                                "<td colspan='2' ><p style='font-size:20px;font-weight: bold;color:white; text-align:center;'><center>Marks Analysis - "+data_array.subject+"</center></p></td>"+
                            "</tr>"+
                            "<tr>"+
                                "<th>Total Marks</th>"+
                                "<td>"+data_array.marks+"</td>"+
                            "</tr>"+
                            "<tr>"+
                                "<th>Positive Marks</th>"+
                                "<td>"+data_array.marks_correct+"</td>"+
                            "</tr>"+
                            "<tr>"+
                                "<th>Negative Marks</th>"+
                                "<td>"+data_array.negmarks+"</td>"+
                            "</tr>"+
                            "<tr>"+
                                "<th>Marks Obtained</th>"+
                                "<td>"+data_array.obt+"</td>"+
                            "</tr>"+
                        "</table>"+
                    "</div>"+

                    "<div class='col-md-6'> "+                   
                        
                        "<div id='container' class='chart_div' align='center'>"+
                            "<canvas id="+canvas_id+" ></canvas>"+
                        "</div>"+
                        
                    "</div>"+
                "</div>"+
            "</div>"+
            "<hr/>";
            count=count+1;

            var chart= document.getElementById("chart");
            chart.innerHTML+=a;
            chart.innerHTML+=b;
            chart.innerHTML+=c;
        }
    }    


<{{!}}/script>
    
<script>
    var count=4;
    var data = jsonData["spr"];
    var len = Object.keys(jsonData).length;
    var sub = ["phy", "chem", "math", "bio", "zoo", "mat", "eng", "lr", "soc", "cs", "gk", "sci","total"];
    for(var i=0;i<13;i++)
    {   
        if(data[sub[i]]==null)
        {
            count=count+3;
            continue;
        }
        else  //For GRAPH subjectwise comparision with total marks also
        {
            var data_array = data[sub[i]];
            var canvas="canvas"+count;
            var barChartData="barChartData"+count; 

            var color = Chart.helpers.color;
            barChartData = {
                labels: ["Student's performance in "+data_array.subject],
                datasets: [{
                    label: 'Total Questions',
                    backgroundColor: color(window.chartColors.grey).alpha(1.5).rgbString(),
                    borderColor: window.chartColors.grey,
                    borderWidth: 3,
                    data: [
                        data_array.ques 
                        
                    ]
                }, {
                    label: 'Correct',
                    backgroundColor: color(window.chartColors.blue).alpha(1.5).rgbString(),
                    borderColor: window.chartColors.blue ,
                    borderWidth: 3,
                    data: [
                        data_array.corr
                        
                    ]
                },{
                    label: 'Wrong',
                    backgroundColor: color(window.chartColors.red).alpha(1.5).rgbString(),
                    borderColor: window.chartColors.red,
                    borderWidth: 3,
                    data: [
                        data_array.wrong
                        
                    ]
                },{
                    label: 'Unattempted',
                    backgroundColor: color(window.chartColors.yellow).alpha(1.5).rgbString(),
                    borderColor: window.chartColors.yellow,
                    borderWidth: 3,
                    data: [
                        data_array.unattempt
                        
                    ]
                }]
            };
            var ctx = document.getElementById(canvas).getContext("2d");
            window.myBar = new Chart(ctx, {
                type: 'bar',
                data: barChartData,
                options: {
                    responsive: true,
                    legend: {
                        position: 'top',
                    },
                    title: {
                        display: true,
                        text: 'Students performance in '+data_array.subject
                    },
                    scales: {
                        yAxes: [{
                            ticks: {
                                //beginAtZero:true
                                min:0
                            }
                        }],
                        xAxes: [{
                            ticks: {
                                //beginAtZero:true
                                min:0
                            }
                        }]
                    }
                }
            });

            count=count+1;
            
            var canvas="canvas"+count;
            var barChartData="barChartData"+count;

            var color = Chart.helpers.color;
            barChartData = {
                labels: [data_array.subject+" analysis"],
                datasets: [{
                    label: 'Correct %',
                    backgroundColor: color(window.chartColors.grey).alpha(1.5).rgbString(),
                    borderColor: window.chartColors.grey,
                    borderWidth: 3,
                    data: [
                        data_array.corr_percent
                        
                    ]
                }, {
                    label: 'Wrong %',
                    backgroundColor: color(window.chartColors.red).alpha(1.5).rgbString(),
                    borderColor: window.chartColors.red,
                    borderWidth: 3,
                    data: [
                        data_array.wrong_percent
                        
                    ]
                },{
                    label: 'Unattempted %',
                    backgroundColor: color(window.chartColors.yellow).alpha(1.5).rgbString(),
                    borderColor: window.chartColors.yellow,
                    borderWidth: 3,
                    data: [
                        data_array.unattempt_percent
                        
                    ]
                },{
                    label: 'Accuracy In Solving',
                    backgroundColor: color(window.chartColors.blue).alpha(1.5).rgbString(),
                    borderColor: window.chartColors.blue,
                    borderWidth: 3,
                    data: [
                        data_array.corr_accuracy
                        
                    ]
                }]

            };
            var ctx = document.getElementById(canvas).getContext("2d");
            window.myBar = new Chart(ctx, {
                type: 'bar',
                data: barChartData,
                options: {
                    responsive: true,
                    legend: {
                        position: 'top',
                    },
                    title: {
                        display: true,
                        text: data_array.subject+' analysis in percentage'
                    },
                    scales: {
                        yAxes: [{
                            ticks: {
                                //beginAtZero:true
                                min:0
                            }
                        }],
                        xAxes: [{
                            ticks: {
                                //beginAtZero:true
                                min:0
                            }
                        }]
                    }
                }
            }); 

            count=count+1;

            var canvas="canvas"+count;
            var barChartData="barChartData"+count;

            var color = Chart.helpers.color;
            barChartData = {
                labels: ["Marks analysis - "+data_array.subject],
                datasets: [{
                    label: 'Total Marks',
                    backgroundColor: color(window.chartColors.grey).alpha(1.5).rgbString(),
                    borderColor: window.chartColors.grey,
                    borderWidth: 3,
                    data: [
                        data_array.marks
                        
                    ]
                }, {
                    label: 'Positive Marks',
                    backgroundColor: color(window.chartColors.blue).alpha(1.5).rgbString(),
                    borderColor: window.chartColors.blue,
                    borderWidth: 3,
                    data: [
                        data_array.marks_correct
                        
                    ]
                },{
                    label: 'Negative Marks',
                    backgroundColor: color(window.chartColors.red).alpha(1.5).rgbString(),
                    borderColor: window.chartColors.red,
                    borderWidth: 3,
                    data: [
                        data_array.negmarks
                        
                    ]
                },{
                    label: 'Marks Obtained',
                    backgroundColor: color(window.chartColors.orange).alpha(1.5).rgbString(),
                    borderColor: window.chartColors.orange,
                    borderWidth: 3,
                    data: [
                        data_array.obt
                        
                    ]
                }]
            };

            var ctx = document.getElementById(canvas).getContext("2d");
            window.myBar = new Chart(ctx, {
                type: 'bar',
                data: barChartData,
                options: {
                    responsive: true,
                    legend: {
                        position: 'top',
                    },
                    title: {
                        display: true,
                        text: 'Performance in '+data_array.subject
                    }
                }
            });
        count=count+1;
    }
}    
<{{!}}/script>
{{/spr}}
</script>

<script src="template.js"></script>

</body>
</html>
